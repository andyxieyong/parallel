Smoothing algorithm with and without shared memory